


$ifi not %DUMB%==yes $goto DUMB_END
+VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
+VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)

$label  DUMB_END

$ifi not %SMART%==yes $goto SMART_END

+VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
+VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
-VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T)

$label  SMART_END

$ifi not %V2G%==yes $goto V2G_END
+VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
+VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
-VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T)

$label  V2G_END



$ifi not %STEPCHARGSCHEME%==yes $goto STEPCHARGSCHEME_END



       +(EV_BEV_Dumb(IY411,IS3,T,IR)*(1/EV_PEFF(IY411)) + EV_PHEV_Dumb(IY411,IS3,T,IR)*(1/EV_PEFF(IY411)))$cs('dumb',IY411)

       +(VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
         +VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
         -VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T))$cs('smart',IY411)

       +(VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
         +VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
         -VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T))$cs('v2g',IY411)

$label  STEPCHARGSCHEME_END

$ifi not %MIXEDFLEET%==yes $goto MIXEDFLEET_END

*Fleet1

       +(EV_BEV_Dumb_n(IY411,IS3,T,IR) * EV_FLEETSIZE(IY411,'BEV_Fleet1') * (1/EV_PEFF(IY411)) + EV_PHEV_Dumb_n(IY411,IS3,T,IR) * EV_FLEETSIZE(IY411,'PHEV_Fleet1') * (1/EV_PEFF(IY411)))$cs1('dumb',IY411)

       +(VEV_VNETCHARGE_BEV_1(IY411,IR,IS3,T)
         +VEV_VNETCHARGE_PHEV_1(IY411,IR,IS3,T)
         -VEV_VNETDISCHARGE_BEV_1(IY411,IR,IS3,T))$cs1('smart',IY411)

       +(VEV_VNETCHARGE_BEV_1(IY411,IR,IS3,T)
         +VEV_VNETCHARGE_PHEV_1(IY411,IR,IS3,T)
         -VEV_VNETDISCHARGE_BEV_1(IY411,IR,IS3,T))$cs1('v2g',IY411)

*Fleet2
       +(EV_BEV_Dumb_n(IY411,IS3,T,IR) * EV_FLEETSIZE(IY411,'BEV_Fleet2') * (1/EV_PEFF(IY411)) + EV_PHEV_Dumb_n(IY411,IS3,T,IR) * EV_FLEETSIZE(IY411,'PHEV_Fleet2') * (1/EV_PEFF(IY411)))$cs2('dumb',IY411)

       +(VEV_VNETCHARGE_BEV_2(IY411,IR,IS3,T)
         +VEV_VNETCHARGE_PHEV_2(IY411,IR,IS3,T)
         -VEV_VNETDISCHARGE_BEV_2(IY411,IR,IS3,T))$cs2('smart',IY411)

       +(VEV_VNETCHARGE_BEV_2(IY411,IR,IS3,T)
         +VEV_VNETCHARGE_PHEV_2(IY411,IR,IS3,T)
         -VEV_VNETDISCHARGE_BEV_2(IY411,IR,IS3,T))$cs2('v2g',IY411)

$label  MIXEDFLEET_END
